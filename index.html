<!DOCTYPE html>
<html lang="kk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>4 “ö–∞–¥–∞–º–¥—ã“õ –û“õ—ã—Ç—É - –¢–∞—Ä–∏—Ö–∏ –§–∞–∫—Ç—ñ–ª–µ—Ä</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;600;700&family=Orbitron:wght@600;700&display=swap" rel="stylesheet">
    <!-- Google Analytics: replace GA_MEASUREMENT_ID with your ID -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-MNS0DY3DYW"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-MNS0DY3DYW');
    </script>
    <!-- Supabase client (set URL/KEY in script.js) -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.45.2/dist/umd/supabase.min.js"></script>
    <!-- Tesseract.js for OCR -->
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
</head>
<body>
    <!-- Cosmic animated background -->
    <div class="space-background">
        <div class="space-gradient"></div>
        <div class="space-gradient-2"></div>
        <div class="space-gradient-3"></div>
        <div class="stars"></div>
        <div class="stars-2"></div>
        <div class="shooting-stars">
            <span class="shooting-star"></span><span class="shooting-star"></span><span class="shooting-star"></span><span class="shooting-star"></span><span class="shooting-star"></span>
            <span class="shooting-star"></span><span class="shooting-star"></span><span class="shooting-star"></span><span class="shooting-star"></span><span class="shooting-star"></span>
        </div>
    </div>
    <header class="global-topbar">
        <div class="top-actions">
            <div class="top-left">
            <div class="lang-pill" id="langPill">
                <button class="lang-btn" data-lang="kk" onclick="switchLang('kk')">KZ</button>
                <button class="lang-btn" data-lang="ru" onclick="switchLang('ru')">RU</button>
                <button class="lang-btn" data-lang="en" onclick="switchLang('en')">EN</button>
            </div>
            </div>
            <div class="top-right">
            <button class="ghost-btn" id="faqBtn" onclick="openFAQ()">FAQ</button>
            <button class="ghost-btn" id="loginBtn" onclick="openLogin()">Login</button>
            <button class="primary-btn" id="signupBtn" onclick="openRegister()">Sign up</button>
            <button class="primary-btn hidden" id="accountBtn" onclick="openAccount()">Account</button>
        </div>
    </div>
    </header>
    <div class="container">

        <!-- Home Section -->
        <section id="homeSection" class="section">
            <h1 id="homeTitle">üéì 4 “ö–∞–¥–∞–º–¥—ã“õ –û“õ—ã—Ç—É</h1>
            <p class="subtitle" id="homeSubtitle">–¢–∞—Ä–∏—Ö–∏ —Ñ–∞–∫—Ç—ñ–ª–µ—Ä–¥—ñ –æ“õ—ã—Ç—É –∂“Ø–π–µ—Å—ñ</p>
            <div class="card-grid">
                <div class="feature-card" onclick="enterLearning()">
                    <div class="feature-icon">üß†</div>
                    <h3 id="feature1Title">4 Step Learning</h3>
                    <p id="feature1Desc">Flashcards, Quiz, Matching, Fill letters</p>
                </div>
                <div class="feature-card disabled">
                    <div class="feature-icon">üóÇÔ∏è</div>
                    <h3 id="feature2Title">Library (coming soon)</h3>
                    <p id="feature2Desc">Saved materials and shared sets</p>
                </div>
                <div class="feature-card disabled">
                    <div class="feature-icon">üìä</div>
                    <h3 id="feature3Title">Teacher dashboard (coming soon)</h3>
                    <p id="feature3Desc">Track students, assign materials</p>
                </div>
            </div>
        </section>

        <!-- Input Section -->
        <div class="section hidden" id="inputSection">
            <div class="input-header">
                <button class="back-btn" onclick="goBackHome()" title="Back to main">‚Üê</button>
                <h2 id="inputTitle">üìù –ú–∞—Ç–µ—Ä–∏–∞–ª–¥—ã –µ–Ω–≥—ñ–∑—ñ“£—ñ–∑</h2>
            </div>
            <textarea id="materialInput" placeholder="–ú–∞—Ç–µ—Ä–∏–∞–ª–¥—ã –∫–µ–ª–µ—Å—ñ —Ñ–æ—Ä–º–∞—Ç—Ç–∞ –µ–Ω–≥—ñ–∑—ñ“£—ñ–∑:
1. –°“±—Ä–∞“õ: –ñ–∞—É–∞–ø
2. –°“±—Ä–∞“õ: –ñ–∞—É–∞–ø
..."></textarea>
            <div class="input-inline-actions">
                <div class="input-badges">
                    <button class="mini-btn" id="correctBtn" onclick="runMaterialCorrector()">üõ†Ô∏è Correct format</button>
                    <button class="mini-btn" id="scanBtn" onclick="openCameraImport()" disabled>üì∑ Scan photo</button>
                    <button class="mini-btn" id="uploadBtn" onclick="openFileImport()" disabled>üìÅ Upload file</button>
                    <button class="mini-btn ghost" id="historyBtn" onclick="showHistory()">üìú History</button>
                </div>
                <div class="input-status" id="ocrStatus"></div>
            </div>
            
            <div class="button-group">
                <button id="startBtn" onclick="showModuleModal()">üöÄ –û“õ—ã—Ç—É–¥—ã –±–∞—Å—Ç–∞—É</button>
                <button id="loadBtn" onclick="openSamplesModal()">üìÑ –ú—ã—Å–∞–ª –∂“Ø–∫—Ç–µ—É</button>
                <button id="clearBtn" onclick="clearInput()">üóëÔ∏è –¢–∞–∑–∞–ª–∞—É</button>
            </div>

            <div class="info-box">
                <strong id="formatTitle">üìå –§–æ—Ä–º–∞—Ç:</strong> <span id="formatText">”ò—Ä–±—ñ—Ä –∂–æ–ª–¥–∞ –Ω”©–º—ñ—Ä, —Å“±—Ä–∞“õ –∂”ô–Ω–µ –∂–∞—É–∞–ø “õ–æ—Å –Ω“Ø–∫—Ç–µ–º–µ–Ω –±”©–ª—ñ–Ω–≥–µ–Ω –±–æ–ª—É—ã –∫–µ—Ä–µ–∫.</span><br>
                <em id="formatExample">–ú—ã—Å–∞–ª—ã: "1. “ö–∞–∑–∞“õ —Ö–∞–Ω–¥—ã“ì—ã–Ω “õ“±—Ä–¥—ã: –ö–µ—Ä–µ–π –º–µ–Ω –ñ”ô–Ω—ñ–±–µ–∫"</em>
            </div>

            <div id="errorMessage" class="error hidden"></div>
        </div>

        <!-- Learning Section -->
        <div class="section hidden" id="learningSection">
            <h2 id="moduleTitle">–û“õ—ã—Ç—É –º–æ–¥—É–ª—ñ</h2>
            
            <div class="progress-bar">
                <div class="progress-fill" id="progressBar">0%</div>
            </div>
            
            <div class="score-board">
                <div class="score-item">
                    <div class="value" id="scoreValue">0</div>
                    <div class="label" id="scoreLabelCorrect">–î“±—Ä—ã—Å</div>
                </div>
                <div class="score-item">
                    <div class="value" id="totalValue">0</div>
                    <div class="label" id="scoreLabelTotal">–ë–∞—Ä–ª—ã“ì—ã</div>
                </div>
                <div class="score-item">
                    <div class="value" id="percentValue">0%</div>
                    <div class="label" id="scoreLabelAccuracy">–î”ô–ª–¥—ñ–∫</div>
                </div>
            </div>

            <!-- Module 1: Flash Cards -->
            <div id="flashcardsModule" class="learning-module">
                <div class="card-counter" id="cardCounter"></div>
                <div id="flashcardContainer"></div>
                <div class="navigation">
                    <button id="prevCardBtn" onclick="previousCard()">‚Üê –ê–ª–¥—ã“£“ì—ã</button>
                    <button id="nextCardBtn" onclick="nextCard()">–ö–µ–ª–µ—Å—ñ ‚Üí</button>
                </div>
            </div>

            <!-- Module 2: Quiz -->
            <div id="quizModule" class="learning-module">
                <div id="quizContainer"></div>
            </div>

            <!-- Module 3: Matching -->
            <div id="matchingModule" class="learning-module">
                <div id="matchingContainer" class="matching-container"></div>
            </div>

            <!-- Module 4: Fill Blanks with Symbols -->
            <div id="fillBlanksModule" class="learning-module">
                <div id="fillBlanksContainer"></div>
            </div>

            <!-- Completion -->
            <div id="completionModule" class="learning-module">
                <div class="completion-screen">
                    <div class="trophy">üèÜ</div>
                    <h2>“ö“±—Ç—Ç—ã“õ—Ç–∞–π–º—ã–∑!</h2>
                    <p>–°—ñ–∑ –±–∞—Ä–ª—ã“õ –º–æ–¥—É–ª—å–¥–µ—Ä–¥—ñ –∞—è“õ—Ç–∞–¥—ã“£—ã–∑!</p>
                    <div class="completion-stats" id="completionStats"></div>
                </div>
            </div>

            <div class="navigation" style="margin-top: 20px;">
                <button id="prevModuleBtn" onclick="previousModule()">‚Üê –ê–ª–¥—ã“£“ì—ã –º–æ–¥—É–ª—å</button>
                <button id="nextModuleBtn" onclick="nextModule()">–ö–µ–ª–µ—Å—ñ –º–æ–¥—É–ª—å ‚Üí</button>
                <button id="resetBtn" onclick="resetLearning()">üîÑ “ö–∞–π—Ç–∞ –±–∞—Å—Ç–∞—É</button>
            </div>
            <div class="navigation finish-row">
                <button id="finishBtn" class="result-btn" onclick="finishAndShowResults()">üìä –ù”ô—Ç–∏–∂–µ</button>
            </div>
        </div>
    </div>

    <!-- Welcome Modal -->
    <div class="modal-overlay" id="welcomeModal">
        <div class="modal welcome-modal">
            <h3 id="welcomeTitle">üéì “ö–æ—à –∫–µ–ª–¥—ñ“£—ñ–∑!</h3>
            <div class="welcome-content" id="welcomeContent">
                <p id="welcomeText1">4 Step Learning –∂–æ–±–∞—Å—ã–Ω–∞ “õ–æ—à –∫–µ–ª–¥—ñ“£—ñ–∑!</p>
                <p id="welcomeText2">–ë“±–ª —Ç–µ–≥—ñ–Ω –ø–∞–π–¥–∞–ª–∞–Ω—É“ì–∞ –∞—Ä–Ω–∞–ª“ì–∞–Ω —Å—ã–Ω–∞“õ –Ω“±—Å“õ–∞—Å—ã.</p>
                <p id="welcomeText3">–ú–∞—Ç–µ—Ä–∏–∞–ª–¥–∞—Ä–¥—ã –æ“õ—ã–ø, –±—ñ–ª—ñ–º –¥–µ“£–≥–µ–π—ñ“£—ñ–∑–¥—ñ —Ç–µ–∫—Å–µ—Ä—ñ“£—ñ–∑.</p>
            </div>
            <div class="modal-buttons">
                <button onclick="closeWelcomeModal()" id="welcomeBtn">‚úì –¢“Ø—Å—ñ–Ω–¥—ñ–º</button>
            </div>
        </div>
    </div>

    <!-- Module Selection Modal -->
    <div class="modal-overlay" id="moduleModal">
        <div class="modal">
            <div class="close-btn" onclick="closeModuleModal()">‚úï</div>
            <h3>üìö –û“õ—ã—Ç—É –º–æ–¥—É–ª—å–¥–µ—Ä—ñ–Ω —Ç–∞“£–¥–∞“£—ã–∑</h3>
            <div class="modal-options">
                <div class="modal-option">
                    <input type="checkbox" id="chkFlashcards" checked>
                    <label for="chkFlashcards">üìá –§–ª—ç—à-–∫–∞—Ä—Ç–∞–ª–∞—Ä</label>
                </div>
                <div class="modal-option">
                    <input type="checkbox" id="chkQuiz" checked>
                    <label for="chkQuiz">‚úÖ –¢–µ—Å—Ç (–¥“±—Ä—ã—Å –∂–∞—É–∞–ø)</label>
                </div>
                <div class="modal-option">
                    <input type="checkbox" id="chkMatching" checked>
                    <label for="chkMatching">üîó –°”ô–π–∫–µ—Å—Ç–µ–Ω–¥—ñ—Ä—É(in progress)</label>
                </div>
                <div class="modal-option">
                    <input type="checkbox" id="chkFillBlanks" disabled>
                    <label for="chkFillBlanks">‚úèÔ∏è ”ò—Ä—ñ–ø—Ç–µ—Ä–¥—ñ –∂–∏–Ω–∞—É(in progress)</label>
                </div>
            </div>
            <div class="modal-buttons">
                <button onclick="closeModuleModal()">‚ùå –ë–æ–ª–¥—ã—Ä–º–∞—É</button>
                <button onclick="startLearning()">‚ñ∂Ô∏è –ë–∞—Å—Ç–∞—É</button>
            </div>
        </div>
    </div>

    <!-- Auth Modal -->
    <div class="modal-overlay" id="authModal">
        <div class="modal auth-wizard">
            <div class="close-btn" onclick="closeAuthModal()">‚úï</div>
            <h3 id="authModalTitle">Login</h3>
            <div id="authStepContainer">
                <!-- Steps injected dynamically -->
            </div>
        </div>
    </div>

    <!-- Account Modal -->
    <div class="modal-overlay" id="accountModal">
        <div class="modal account-modal">
            <div class="close-btn" onclick="closeAccount()">‚úï</div>
            <h3 id="accountTitle">Account</h3>
            <div id="accountInfo"></div>
            <div class="modal-buttons">
                <button onclick="logout()">üö™ Logout</button>
            </div>
        </div>
    </div>

    <!-- FAQ Modal -->
    <div class="modal-overlay" id="faqModal">
        <div class="modal">
            <div class="close-btn" onclick="closeFAQ()">‚úï</div>
            <h3 id="faqTitle">FAQ</h3>
            <div id="faqContent">
                <div id="faqText" class="faq-list"></div>
            </div>
            <div class="modal-buttons">
                <button onclick="closeFAQ()">OK</button>
            </div>
        </div>
    </div>

    <!-- Samples Modal -->
    <div class="modal-overlay" id="samplesModal">
        <div class="modal samples-modal">
            <div class="close-btn" onclick="closeModalById('samplesModal')">‚úï</div>
            <h3 id="samplesTitle">–ú—ã—Å–∞–ª–¥–∞—Ä</h3>
            <div id="samplesList"></div>
            <div class="modal-fields">
                <input type="text" id="sampleName" placeholder="Sample name">
                <textarea id="sampleText" placeholder="Sample content"></textarea>
            </div>
            <div class="modal-buttons">
                <button onclick="addSample()">‚ûï Add</button>
                <button onclick="insertSample()">üì• Insert</button>
            </div>
        </div>
    </div>

    <!-- Hidden inputs for OCR -->
    <input type="file" id="fileInput" accept=".png,.jpg,.jpeg,.pdf" class="hidden">
    <input type="file" id="cameraInput" accept="image/*" capture="environment" class="hidden">

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <script src="script.js"></script>
    <script type="module">
        import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm"
      
        const supabase = createClient(
          "https://wuciyhbdwzesnzinbux.supabase.co",
          "PUBLIC_ANON_KEY"
        )
      
        // ‚¨áÔ∏è –ì–õ–ê–í–ù–û–ï
        await supabase.auth.getSession()
      
        // –ß–∏—Å—Ç–∏–º hash
        if (location.hash) {
          history.replaceState(null, "", location.pathname)
        }
      
      </script>
      <script>
        fetch("https://ozgergsheets.kengot987654321.workers.dev/")
          .then(res => res.json())
          .then(data => {
            console.log(data.values);
          });
        </script>
      </body>
      </html>
</body>
</html>
